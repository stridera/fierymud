
SCRIPT HELP FILE USE FIND IN PAGE ---- TO JUMP FROM SECTION TO SECTION
iI SAY TAHNK YOU TO ERIC GREEN FOR THIS HELP FILE.



------------TRIGGERS---------------
A trigger consists the type, information on when to execute it, a list of commands, and a list of
variables. Each class of game object (mobiles, objects, and rooms) have their own set of triggers.
The trigger types are explained in the following format:

  
Type [ASCII flag]
     Description: This describes the event the trigger reacts to.
     Argument: This is the argument of the trigger, used for determining if a trigger is to be run. It
     is one or more words.
     NArg: This is the numerical argument, used to determine if a trigger is run. It must be a
     number.
     Return value: This explains what effects a return statement can have.
     Variables: This is a list of variables which may be set by the game when the trigger is run. 

The following is a list of trigger types. More can be added by request. 


Mob Triggers

  
Global [a]
     Description: This is not a trigger by itself, but is used with another trigger type. A trigger
     which is global is checked even if there are no PCs in the same zone as the mob.
     Argument: Not used.
     NArg: Not used.
     Return value: Not used.
     Variables: None. 

      

Random [b]
     Description: This trigger is checked periodically (about every thirteen seconds). The trigger is
     not checked if there is no PC in the same zone as the mob, unless it is also a Global trigger
     (see above).
     Argument: Not used.
     NArg: The chance this trigger will be run when it is checked.
     Return value: Not used.
     Variables: None. 

      

Command [c]
     Description: This trigger is checked whenever a character types an invalid command, or a
     command which usually results in a 'Sorry, but you cannot do that here!' message, in the same
     room as the mob with this rigger. If the command typed is a substring of the argument, the
     trigger is called.
     Argument: The command name.
     NArg: Not used.
     Return value: If 0 is returned by the trigger, the character will receive the same message as if
     the trigger did not exist, and any other command triggers will be checked.
     Variables:
          actor is set to the character typing the command.
          arg is set to the argument of the command. 

      

Speech [d]
     Description: This trigger is checked whenever someone says something around a mob with
     this trigger. If NArg is 0, the trigger checks to see if Argument is a substring of what was said.
     If NArg is 1, the trigger checks to see if any word in Argument matches a word of what was
     said to see if the trigger should be called.
     Argument: The phrase or word list to be matched
     NArg: If this is 0, Argument is a phrase. If it is 1, Argument is a word list.
     Return value: Not used.
     Variables:
          actor is set to the character speaking. 

      

Act [e]
     Description: This trigger is runs when Argument is a substring of a string of text that a mob
     sees. The text can come only come from certain output (those generated by the act() function
     of the game). This includes most messages, such as socials, damage messages, and skill
     messages. Text from players, such as echo, emote, say, and tell, are not checked. If you have
     a specific question whether a message is checked, ask an implementor.
     Argument: The phrase or word list to be matched
     NArg: If this is 0, Argument is a phrase. If it is 1, Argument is a word list.
     Return value: Not used.
     Variables: Not all the variables will be set. Which ones are set and to what depends on the
     message. If you have trouble, ask an implementor. The variables will be set to the right
     character or object, even if 'someone' or 'something' is used instead of the name.
          actor is set to the primary character in the text.
          victim is set to the secondary character in the text.
          object is set to the primary object of the text.
          target is set to the secondary object of the text.
          arg is set to the variable string portion of the text, such as a door name. 

      

Death [f]
     Description: This trigger is checked when the mobile dies.
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when checked.
     Return value: If the return value is 0, the mob's death cry (such as 'Your blood freezes as
     you hear the beastly fido's death cry.') will not be heard. For any other value, the normal
     death cry will be heard.
     Variables:
          actor will be set to the killer, if there is one. 

      

Greet [g]
     Description: This trigger is checked when someone enters the room, and the mob with the
     trigger can see the person entering.
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when checked.
     Return value: Not used.
     Variables:
          actor is set to be the character entering the room.
          direction is set to the name of the direction the actor entered from.

      

Greet-All [h]
     Description: This trigger is the same as the Greet trigger, except that it is checked even if the
     mob can not see the actor.
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when checked.
     Return value: Not used.
     Variables:
          actor is set to be the character entering the room.
          direction is set to the name of the direction the actor entered from. 

      

Entry [i]
     Description: This trigger is checked every time the mobile enters a room.
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when checked.
     Return value: Not used.
     Variables: None. 

      

Receive [j]
     Description: This trigger is checked when an object is given to the mob.
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when checked.
     Return value: If 0 is returned, the object will not be transferred to the mob. For any other
     number, the normal result will occur.
     Variables:
          actor is set to the character giving the mob the object.
          object is set to the object being given. 

      

Fight [k]
     Description: This trigger is checked every round the mob is fighting, after all mob has had its
     attacks.
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when checked.
     Return value: Not used.
     Variables:
          actor is the character the mob is fighting. 

      

Hitprcnt [l]
     Description: This trigger is checked during combat when the mob's hit points drop below the
     percentage specified by NArg.
     Argument: Not used.
     NArg: This is the percentage of hit points a mob must drop below for the trigger to be
     checked.
     Return value: Not used.
     Variables:
          actor is set the the character fighting the mob. 

      

Bribe [m]
     Description: This trigger is checked when coins are given to a mob.
     Argument: Not used.
     NArg: This is the minimum number of coins that must be given to the mob for the trigger to be
     run.
     Return value: Not used.
     Variables:
          actor is set to be the character giving the mob the coins.
          amount is the number of coins given to the mob. 



Item Triggers

  
Global [a]
     Description: This is not a trigger by itself, but is to be used with the random trigger. A trigger
     which is global is checked even if there are no PCs in the same zone as the object. (This
     trigger is not yet implemented.)
     Argument: Not used.
     NArg: Not used.
     Return value: Not used.
     Variables: None. 

      

Random [b]
     Description: This trigger is checked periodically (currently every thirteen seconds).
     Argument: Not used.
     NArg: The chance this trigger will be run when it is checked.
     Return value: Not used.
     Variables: None. 

      

Command [c]
     Description: This trigger is checked whenever a character types an invalid command, or a
     command which usually results in a 'Sorry, but you cannot do that here!' message, around the
     object with this trigger. If the command typed is a substring of the argument, the trigger is
     called.
     Argument: The command name.
     NArg: This determines where the item must be for the trigger to be run. A 1 means the item
     must be in the character's equipment for it to be used. A 2 means the item must be in the
     character's inventory. A 4 means the item must be in the same room as the character. These
     can be added together so the item can be in more than one place. For example, if NArg was
     3, the trigger would work if the item was in the character's inventory or equipment. A 7 would
     mean the trigger would work in the character's inventory, equipment, or in the room.
     Return value: If 0 is returned by the trigger, the character will receive the same message as if
     the trigger did not exist, and any other command triggers in the room will be checked.
     Variables:
          actor is set to the character typing the command.
          arg is set to the argument of the command. 

      

Fight [d]
     Description: This trigger is checked periodically (currently every thirteen seconds) while a
     fight occurs in the same room as the object.
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when checked.
     Return value: Not used.
     Variables:
          actor is a random character who is fighting in the objects room. 

      

Get [g]
     Description: This trigger is checked whenever the item is picked up.
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when checked.
     Return value: If 0 is returned, the object is not picked up. For any other value, the object
     will go to the character's inventory as normal.
     Variables:
          actor is set to the mob that picks up the object. 

      

Drop [h]
     Description: This trigger is checked when a character attempts to drop an object with a
     Drop trigger.
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when checked.
     Return value: If 0 is returned, the object is not dropped. For any other value, the object will
     go to the room as normal.
     Variables:
          actor is set to the character attempting to drop the item. 

      

Give [i]
     Description: This trigger is checked whenever someone attempts to give away the object.
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when checked.
     Return value: If the return value is 0, the object will not be given to the victim. For any other
     return value, the give will occur normally.
     Variables:
          actor is the character giving the object.
          victim is the character receiving the object. 

      

Wear [j]
     Description: This trigger is checked whenever a mob attempts to wear the item.
     Argument: Not used.
     NArg: Not used.
     Return value: If 0 is returned, the item is not worn.
     Variables:
          actor is set to the mob that is attempting to wear the object. 



Room Triggers

  
Global [a]
     Description: This is not a trigger by itself, but is used with another trigger type. A trigger
     which is Global is checked even if there are no PCs in the zone.
     Argument: Not used.
     NArg: Not used.
     Return value: Not used.
     Variables: None. 

      

Random [b]
     Description: This trigger is checked periodically (every 13 seconds). The trigger is not
     checked if there is no PC in the same zone as the room, unless it is also a Global trigger (see
     above).
     Argument: Not used.
     NArg: The chance this trigger will run when it is checked.
     Return value: Not used.
     Variables: None. 

      

Command [c]
     Description: This trigger is checked whenever a character types an invalid command, or a
     command which usually results in a 'Sorry, but you cannot do that here!' message, in the room
     with this trigger. If the command typed is a substring of the argument, the trigger is called.
     Argument: The command name.
     NArg: Not used.
     Return value: If 0 is returned by the trigger, the character will receive the same message as if
     the trigger did not exist, and any other command triggers will be checked.
     Variables:
          actor is set to the character typing the command.
          arg is set to the argument of the command. 

      

Speech [d]
     Description: This trigger is checked whenever someone says something in the room. If NArg
     is 0, the trigger checks to see if Argument is a substring of what was said. If NArg is 1, the
     trigger checks to see if any word in Argument matches a word of what was said to see if the
     trigger should be called.
     Argument: The phrase or word list to be matched
     NArg: If this is 0, Argument is a phrase. If it is 1, Argument is a word list.
     Return value: Not used.
     Variables:
          actor is set to the character speaking. 

      

Enter [g]
     Description: This trigger is checked whenever someone enters the room. This trigger is
     checked just before the character enters the room, so if you want the action to occur in the
     room the character is entering, you must use a wait, or teleport the character. (See Script
     Commands for more information on wait and teleport.)
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when checked.
     Return value: If the return value is 0, the character will not enter the the room. For any other
     return value, the character enters the room as normal.
     Variables:
          actor is set to the character that entered the room. 

      

Drop [h]
     Description: This trigger is checked with a character attempts to drop something in the room.
     This trigger is checked just before the character actually drops the item.
     Argument: Not used.
     NArg: This is the percent chance that the trigger will be run when it is checked.
     Return value: If 0 is returned, the item will not be dropped. Otherwise, the item is dropped
     as normal.
     Variables:
          actor is set to the character dropping the item.
          object is set to the item being dropped.
		  

TUTorial-------------------

This section is a step by step tutorial to explain the basics on writing scripts. It goes through the
script creation process developing a practical script. For more details for a step, refer to the
appropriate section in the later portion of this document.

   1.Decide what the script should do. 
     First, consider how your mob, item, or room should behave. Doing this before worrying what
     can be done prevents you from limiting yourself to what you have seen other scripts do, and
     produces a more interesting script.

          For example, I want to create a gate guard for outside wildgate. The baron of
          the city has decided that each groups of people will be charged a hundred coins
          to enter from the wilderness. The gate guard must notify travelers of the cost to
          enter, collect the money, allow people who have payed to enter the city, and
          close the gate after them. This will be a mob script. 

   2.Decide what trigger types you need.
     Look through the section on triggers to see the currently available trigger types. New triggers
     can be added by Melleth if needed.

          Our gate guard needs to react to three different events:

          a. A character entering the room from the south, the road leading into Gallows
          wood, needs to be informed of the price for entrance. If a character comes from
          Sawville the guard will close and lock the gate behind them. This will be a greet
          trigger.

          b. When the guard is given 100 or more coins, the guard must unlock and open
          the gate. Tell the character to hurry, then close and lock the gate after them. This
          is done by a bribe trigger.

          c. If the guard is given less than 100 coins, the guard needs to inform the
          character that it is insufficient and return the coins. This is also a bribe trigger.

   3.Determine the argument and the numerical argument (NArg) of the triggers.
     Read the specifications on trigger types, and decide what the values for argument and NArg
     must be for the trigger to react appropriately to the events.

          a. The argument for the greet trigger is not used. The NArg is the percent chance
          that the trigger is run when checked. Since I want it run every time someone
          enters the room, it should be 100.

          b. The argument for the bribe trigger is not used. The NArg is the minimum
          amount that must be given to the guard for him to react. The guard should only
          open the gate when given 100 coins, so NArg should be 100.

          c. For this bribe trigger, the guard must respond whenever someone gives him 1
          or more coins, so NArg should be 1.

   4.Write the list of commands for the trigger.
     This is the most complex and time consuming part of a trigger to write. The valid commands
     are explained in the Commands chapter. Variables and expressions are also used in the
     commands list, which are covered in later sections.

          a. For the greet trigger, I want the guard to inform anyone entering from the
          south how to get into the city. First, I must check if the character is entering from
          the south. If they are entering from that direction, the guard should tell the
          character the cost of entry. If a character comes through the gate the guard will
          inform them the gate should be locked, and close it and lock it The command list
          for this trigger will be as follows: 

          if (%direction% == south)
          wait 1
          emote snaps to attention as you approach.
          wait 1 s
          say Admittance to the city is now 100 coins for your group.
          elseif (%direction% == north)
          wait 1
          say This gate should really be kept closed at all times.
          mload obj 1097
          wait 5 s
          close gate
          wait 1 s
          lock gate
          mjunk obj key
          end
            

          Checking the specifications of the greet trigger, we see that the variable
          “direction” is set to the direction that the character entered. The percent sign
          surrounding direction means it is a variable. The two equal signs together
          compare the value of the variable to the word “south”. If these are equal, the
          statements between this line and the line “else” will be executed. The “wait 1”
          pauses briefly (about 0.1 second) while the character finishes his move. (The
          greet trigger is actually checked before the character enters the room, so if we
          did not have this line, he or she would never see the guard snap to attention.)
          After another brief pause of 1 second, the guard announces the cost to enter the
          town. If the direction is not north, but is south, then the statements after the else
          are executed. First the pause, then the guard says the gate should be closed. The
          guard then loads the key to the gate, waits 5 second, then closes and locks the
          gate. The key is then junked. 

          b. The guard must open the gate if 100 or more coins were given to him. The
          command list looks like this:

          wait 1
          say Thankyou %actor.name%, the toll is paid!
          mload obj 1097
          wait 1 s
          unlock gate
          wait 1 s
          open gate
          say Hurry along now %actor.name%, the gate should not be open long.
          wait 10 s
          close gate
          lock gate
          mjunk obj key
            

          After a brief wait (so everything doesn’t happen at once), the guard unlocks the
          gate and opens it. The guard will close the gate after 10 seconds, even if no one
          passes through it.

          c. The guard must inform the character that his payment was not enough, and
          return the money. The commands list will be:

          wait 1
          say %actor.name%! I said 100 coins.
          wait 1 s
          give %amount% coins %actor.name%
            

          For the line "give %amount% coins %actor.name%", the variables amount
          and actor, both set when the bribe trigger is called, are substituted into the line
          before the guard performs the command. The gate guard returns the number of
          coins he was given.

   5.Decide the order of the triggers.
     The triggers are checked from first to last. If there are two triggers of the same type, the first
     one run will be the only one run.

   6.Write the trigger file.
     Use trigedit <vnum> to edit a trigger in one of you zones. Put the triggers into the game. For
     rooms this is easy, use redit to assign the scripts to the room. For objects and mobiles it is
     harder as there are many of each in the game! To put a script on a prototype you use medit or
     oedit to add the script, this will write the .mob or .obj file. The scripts will be on all instances
     after a zone reset if the mobiles have been purged or after a game reboot. To add to a mob or
     obj in the game use ‘attach’, this will add the script to one particular mob or obj in the room
     or in your possesion. Good for testing :) ....
     If you must write it yourself, refer to the chapter on zone files.

   7.Test the script.
     You should see how the script actually work in the game, and watch other people interact
     with it. Often you will see ways you can improve it. ‘detach’ will remove a script from a room,
     mobile or object if it is not working properly :(


	 ------------------COMMANDS--------------------

	 Script Specific Commands

* text 
     An '*' at the beginning of a line is a comment. The rest of the line is ignored. 

global variable 
     Global changes variable into a global variable. 

eval variable expression 
     Eval evaluates expression and sets variable to result. See section 7 for details on how
     expression evaluation works.
          Example: eval foobar 15 - 5
          sets the variable foobar to the value 10

if (expression)
...
elseif (expression)
...
else
...
end 
     An 'if' must occur before the other three. If expression evaluates to true (see the
     Expressions for more detail on expression evaluation), the statements between the if statement
     and the next elseif, else, or end are executed. If it stopped at an elseif or else, it scans for the
     next end, and continues execution at that point. If the expression evaluated to false, it searches
     for the next elseif, else, or end. If it finds an elseif, it checks that expression. If it is true, it
     executes the statements between the elseif and the next elseif, else, or end, and then finds the
     end of the block. If it is false, it continues searching in the same pattern, until a true elseif is
     found, an else is found, or an end is found. 

halt 
     Halt ends the trigger execution. 

return value 
     Return sets the return value of the trigger. Normally, a script will return 1, unless another
     return value is specified with the return command. Unlike most computer languages, the return
     command does not end the trigger's execution. The value is returned after all the commands
     have been executed, or a wait or halt command is called. 

set variable value 
     Set sets variable to value, without evaluating it. 
          Example: set foobar 15 - 5
          sets the variable foobar to the string "15 - 5"

unset variable 
     Unset eliminates the specified variable if it exists. 

wait duration
wait until time 
     A wait command causes the trigger to pause for a certain length of time. If just a numerical
     argument is given, the pause will be for that many of pulses (currently 0.1 seconds). If the
     number is followed by an 's', the pause will be in real life seconds. If the number is followed
     by a 't', the pause will be in tics (game hours). If wait until is used, the trigger is paused
     until time. Time may be of the form HH:MM or HHMM (e.g. 14:30 or 1430). 



Game Commands

Normal game commands can be used in triggers. Each type of game object has a separate set of
commands available to it. 

Mob Commands

Mobs can use any game command available to a mortal player character of the same class and level
as the mob. In addition, they can use the following special commands. 

masound message 
     Masound echoes message to the all the rooms the exits of the mob's room lead to. 

mat target command 
     The command is performed by the mob at the specified target. The target may be a room
     number, character name, or object name. The target room can not be a private or god room.
     Valid commands are any commands usable by a mob. 

mecho message 
     Mecho sends message to everyone awake in the same room as the mob. 

mechoaround victim message 
     This sends message to everyone in the room except for victim and the mob. 

mexp victim amount 
     Mexp changes the victim's experience points by amount. The amount may be 25,000 exp
     and less, including negative values. 

mgold victim amount 
     Mexp changes the victim's carried gold by amount. The amount may, include negative values.

mforce victim command 
     The mob forces victim to perform the command. If victim is 'all', all the characters in the
     room are forced to perform the command. Immortals are not affected by this command. No
     message is sent to the character, except what is caused by the command performed. 

mgoto target 
     This command moves the mob to the given target. The target may be an object, room, or
     character, as long as it is not in a private occupied with two or more characters, or god room.
     No message is given. 

mjunk object 
     The object in the mob's inventory specified is removed from the game. 'Mjunk all' removes all
     of the objects in the mob's inventory. No message is sent by this command. 

mkill victim 
     Mkill causes the mob to hit the victim. It is the same as kill, except mkill works for low level
     mobs attacking PCs, where kill does not. 

mload <obj|mob> vnum 
     This command loads a mob or object into the game. Mobs are loaded in the same room as
     the mob using the command. No-take objects are loaded into the mob's room, and all other
     objects are loaded into the mob's inventory. The object or mob's vnum must be specified; the
     name will not work. No message is given. 

mpurge [target] 
     Mpurge removes objects or mobs from the game. If no argument is given, then all objects and
     mobs in the room will be removed. If there is an argument, only that mob or object will be
     purged. PCs can not be purged with this command. There is no message when this command
     is used. 

msend victim message 
     The victim of msend gets the message. 

mteleport victim target 
     Mteleport moves the victim to the target. The victim does not need to be in the same room as
     the mob. If the victim is 'all', all the characters in the room will be teleported to the target
     room. No messages are generated by this command. 

mcast victim 'spell' 
     Mcast will have the effect of the mob casting the spell at the target. 



Object Commands

Items can use the following commands. 

oecho message 
     Oecho sends message to everyone awake in the same room as the object. If the object is
     equipped or carried by someone or in something, message is sent to the room the person or
     object is in. 

oechoaround victim message 
     This sends message to everyone in the room, except for the victim and the mob. 

oexp victim amount 
     Oexp changes the victim's experience points by amount. The amount may be 25,000 exp and
     less, including negative values. 

oforce victim command 
     The object forces victim to perform command. If the victim is 'all', all the characters in the
     room are forced to perform the command. Immortals are not affected by this command. No
     message is set to the character, except what is caused by the command performed. 

opurge [target] 
     Opurge removes objects or mobs from the game. If no argument is given, then all objects and
     mobs in the room will be removed. If there is an argument, only that mob or object will be
     purged. PCs can not be purged with this command. There is no message when this command
     is used. 

osend victim message 
     Message is sent to victim. 

oteleport victim target 
     Oteleport moves victim to target. The victim does not need to be in the room. If the
     victim is 'all', all the characters in the room will be teleported to the target room. No messages
     are generated by this command. 

oload <obj|mob> vnum 
     This command loads a mob or object into the game. Mobs are loaded in the same room as
     the obj using the command. The object or mob's vnum must be specified; the name will not
     work. No message is given. 

odamage victim amount 
     This command causes the amount of damage in hitpoints to be subtracted from the victim. 

oheal victim amount 
     This command causes the amount of damage in hitpoints to be added to the victim. 



World Commands

Room triggers can use the following commands. 

wasound message 
     Wasound echos message to all the rooms adjacent to the room wasounding. 

wdoor room direction field [value] 
     This command is used for adding, deleting, and modifying doors in room. Direction
     determines which door is being changed, and can be north, south, east, west, up,
     or down. If the door does not exist first, a new door will be created. Field is what property
     of the door is being changed. Valid fields are:

     purge 
          Removes the door completely. Value is not used. 
     description 
          Value will be the new exit description. 
     flags 
          Value will be the new door flags. This is a list of letters representing all the door flags.

            'a'      EX_ISDOOR  Exit has a door that can be opened and closed.
            'b'      EX_CLOSED  The door is closed
            'c'      EX_LOCKED  The door is locked
            'd'      EX_PICKPROOF Lock can't be picked
            'e'      EX_SECRET  The door is secret
            

          For example, "wdoor 100 north flags abe" creates a closed, secret door to the
          north in room 100. 
     key 
          Value is the object number of the new key. 
     name 
          Value is the new name of the door. 
     room 
          Value is the room this door will connect to. 

wecho message 
     Wecho sends message to everyone awake in the room. 

wechoaround victim message 
     This sends message to everyone in the room except for victim. 

wexp victim amount 
     Oexp changes victim's experience points by amount. The amount may be 25,000 exp and
     less, including negative values. 

wforce victim command 
     The room forces victim to perform command. If victim is 'all', all the characters in the
     room are forced to perform the command. Immortals are not affected by this command. No
     message is sent to the character, except what is caused by the command performed. 

wload <obj|mob> vnum 
     This command loads a mob or object into the game, in the room performing the command.
     The object or mob's vnum must be specified; the name will not work. No message is given. 

wpurge [target] 
     Wpurge removes objects or mobs from the game. If no argument is given, the all objects and
     mobs in the room will be removed. If there is an argument, only that mob or object will be
     urged. PCs can not be purged with this command. There is no message generated by this
     command. 

wsend victim message 
     Message is sent to victim. 

wteleport victim target 
     Wteleport moves victim to target. The victim does not need to be in the room. If the
     victim is 'all', all the characters in the room will be teleported to the target room. No messages
     are generated by this command. 

wzoneecho zone message 
     Message is sent to the entire zone specified. 

wdamage victim amount 
     This command causes the amount of damage in hitpoints to be subtracted from the victim. 

wheal victim amount 
     This command causes the amount of damage in hitpoints to be added to the victim. 

wat room command 
     The command is performed by the room at the specified room vnum. The target must be a
     room number. The target room can not be a private or god room. Valid commands are any
     commands usable by a script. 

	--------------------VARIABLES----------------------
Variables appear as a name surrounded by '%'s, such as 

     %actor% 

Before a command is processed, the line is scanned and any variables are replaced. First the list of
local variables are checked to see if the variable is there. If not, the global variables are checked. If a
match is still not found, a list of 'built in' variables (ones not declared by the script) are checked. If no
match is found, the variable is replaced with an empty string (the variable is removed from the line,
and nothing added in its place). Two '%'s in a row will be interpreted as a single '%'. 

There are two types of variables, local and global. All local variables are deleted when a trigger
finishes executing, and can only be used by the trigger. Global variables remain until removed with
unset, or the script is removed. 



                               Variable Fields

A field of a variable can also retrieved, based on their type. To get a field, a notation of
%variable.field% is used. The valid fields for each type of game object are listed below.

Characters

     alias 
          The list of aliases of the character. 
     str 
          The character's strength. 
     stradd 
          The character's strength add. 
     int 
          The character's intelligence. 
     wis 
          The character's wisdom. 
     dex 
          The character's dexterity. 
     con 
          The character's constitution. 
     cha 
          The character's charisma. 
     class 
          The character's class, as a string. 
     level 
          The character's current level. 
     legal 
          The character's current legal status. 
     align 
          The character's current alignment. 
     hp 
          The character's current hitpoints. 
     maxhp 
          The character's maximum hitpoints. 
     gold 
          The character's carried gold. 
     name 
          The character's name (the short description for mobs). 
     title 
          The character's title (blank for mobs). 
     race 
          The character's race, as a string. 
     sex 
          The character's sex, as a string (MALE, FEMALE, or NEUTRAL). 
     vnum 
          The character's virtual number. -1 for PCs. 
     canbeseen 
          Can the mobile see the character? YES=1 NO=0. 
     room 
          The character's current room number. 

Objects

     name 
          The list of key words of the object. 
     shortdesc 
          The name of the object that players see. 
     type 
          The type of object, such as WAND, ARMOR, or KEY. 
     val0 
          Value 0 of the object, defined in values.doc. 
     val1 
          Value 1 of the object, defined in values.doc. 
     val2 
          Value 2 of the object, defined in values.doc. 
     val3 
          Value 3 of the object, defined in values.doc. 
     vnum 
          The virtual number of the object. 

Rooms

     name 
          The name of the room. 
     north 
          The list of flags affecting the north exit. 
     east 
          The list of flags affecting the east exit. 
     south 
          The list of flags affecting the south exit. 
     west 
          The list of flags affecting the west exit. 
     up 
          The list of flags affecting the upward exit. 
     down 
          The list of flags affecting the downward exit. 



Special Variables

     self 
          The mob, item, or room running the script. Normal fields may be used with this. 
     random 
          This variable returns a number between 1 and the field value. For example,
          %random.10% would be a value between 1 and 10. 

Variables are case insensitive.

----------------EXPRESSIONS---------------------

A false expression is any expression that evaluates to 0, or an empty string. A true expression is any
expression that evaluates to anything other than a false expression. The following list are the
recognized operators. The higher the operator is on the list, the higher the precedence. The
expression is evaluated from left to right. Parenthesis can be used to group.

       Operator 
                          Name 
                                                    Examples 
          || 
                         logical or 
                                                0 || ( ) = 0; 5 || 0 = 1
         && 
                        logical and 
                                              1 && 0 = 0; 5 && 3 = 1
         == 
                        equivalence 
                                             5 == 3 = 0; dog == DoG = 1
         != 
                         inequality 
                                              0 != Z = 0; dog != d = 1
          < 
                         less than 
                                                4 < 3 = 0; 4 < 5 = 1
          > 
                        greater than 
                                                4 > 3 = 1; 4 > 4 = 0
         <= 
                      less than or equal 
                                               4 <= 3 = 0; 4 <= 5 = 1
         >= 
                    greater than or equal 
                                               4 >= 3 = 1; 4 >= 4 = 1
          /= 
                         substring 
                                                "concatenate" /= "cat"
          - 
                        subtraction 
                                                   15 - 10 = 5
          + 
                         addition 
                                                   10 + 15 = 25
          * 
                       multiplication 
                                                  10 * 20 = 400
          / 
                         division 
                                                   100 / 20 = 5
          ! 
                         negation 
                                              !() = 1; !0 = 1; !dog = 0;


-------------------TRIGGER FILE--------------------------
NOTE THIS MAINYL FOR REFRENCE FOR TRIGEDIT WILL MAKE THESE FILES

There are three different types of trigger files, one for mob triggers, one for item triggers, and one for
wld triggers. These are read at boot-time. It follows this format:


#<virtual number>
<name>~
<type> <number arg>
<arg list>~
<command 1>
<command 2>
.
.
.
<command n>~
#<virtual number>

.
.
.

$~ 


Explanation of the fields

Virtual Number (VNum) 
     A number for the trigger. No two triggers for the same game object type (mob, item, or
     room), can have the same number. The virtual number must always be increasing as you go
     down the file, but the increments can be greater than one.

Name 
     The name of the trigger. This is used as a reference for manipulating triggers, though the virtual
     number will also work.

Type 
     This is the list of ASCII flags which specify the trigger types. The order does not matter, but it
     is case sensitive and there can not be spaces between the letters. See sections 4 for a list and
     description of types.

Number Argument (NArg) 
     This is an integer which helps to determine if a trigger is executed. This field may not be used
     by some trigger types, but some number must always be in this place. The exact meaning is
     determined by the trigger type (see section 4 for details).

Argument List (Arg) 
     This is a string field which is used to determine if a trigger is executed. It may not be used by
     some trigger types and can be left blank by putting a tilde on the line by itself. The exact
     meaning is determined by by the trigger type (see section 4 for details).

Commands 
     These are a series of commands, each separated by a newline, and terminated by a tilde.
     Valid commands are covered in section 5.

Example of a trigger entry 


    #100
    gateguard greet~
    g 100
    ~
    if (%direction% == north)
      wait 1
      emote snaps to attention as you approach.
      wait 1
      say Admittance to the city is now 10 coins for your group.
    end~
    #101
    gateguard pay 10~
    m 10
    ~
    wait 1
    unlock gate
    open gate
    wait 10
    close gate
    lock gate~
    #102
    gateguard pay 1~
    m 1
    ~
    wait 1
    say This is not enough!
    give %amount% coins %actor%~
    #103
    gateguard enter city~
    e 0
    leaves south.~
    wait 1
    close gate
    lock gate~
    #104
    gateguard gate opened~
    e 0
    The gate is opened from the other side~
    wait 5
    close gate
    lock gate~
    #99999
    $~

	---------------ZONE TRIGGERS--------------------

	One new command, with three different formats, are used in the zone file to allow triggers to load
automatically with zone resets. Refer to database.doc for more detail of the zone file.

Mobile

T <if-flag> 0 <trigger number> <max existing> 0

     This adds a trigger to the last mob loaded. If the if-flag is non-zero, the command is
     executed only if the previous command was executed. If the number of triggers of this
     kind is greater than or equal to max existing, this command will not be executed.

Object

T <if-flag> 1 <trigger number> <max existing> 0

     This adds a trigger to the last object loaded. If the if-flag is non-zero, the command is
     executed only if the previous command was executed. If the number of triggers of this
     kind is greater than or equal to max existing, this command will not be executed.

World

T <if-flag> 2 <trigger number> <max existing> <room number>

     This adds a trigger to the specified room. If the if-flag is non-zero, the command is
     executed only if the previous command was executed. If the number of triggers of this
     kind is greater than or equal to max existing, this command will not be executed.

------------WIZARD COMMANDS----------------------

The following are commands available to game wizards.

attach <mtr | otr | wtr> <trigger vnum> <target> [<location>]

     Adds a trigger to the mob, object, or room specified. Location indicates which position the
     new trigger should be in. The location parameter is optional, with the default being the last
     position.

detach [mob | object] <name> <trigger number | all>

     Removes a trigger from the mob, object, or room specified. "All" will remove all the triggers.
     If a number is used instead, the trigger in that position on the script will be removed.

vstat [object | mobile] <virtual number>

     Vstat displays information the script of a mob or object. A list of triggers of the script and
     their states, along with global or local variables are listed.

tlist <start number> <end number>

     Gives a list of the virtual numbers of mob triggers (mtr), object triggers (otr), and world
     triggers (wtr) which have the specified name.

tstat <script virtual number>

     Used to stat a prototypical mob, object, or world trigger by virtual number.

trigedit <virtual number>

     This will start the editor so you can write or modify the scripts online.

--------------GLOSSARY----------------------------

Character 
     A game object which represents a living organism, capable of moving around on its own.
     Characters can exist only inside rooms. Examples of characters are players and mobiles.

Game Object 
     A thing represented by a complex structure which can be acted upon by the game. Game
     objects include characters, items, rooms, and triggers.

Immortal 
     A game administrator, having special commands to manipulate the game in ways that normal
     players can not.

Item 
     A game object which can be used by characters. Items can be in a room, carried by a
     character, held by a character, or inside another item. Also referred to as objects (note the
     difference between objects and game objects though). Examples of items are swords,
     fountains, and books.

Mobile (mob) 
     Traditionally, a game object capable of moving around without assistance. A non-player
     character, controlled by the game. Examples of mobs are city guards and fidos.

Room 
     A game object representing a volume in space. Rooms can contain items and characters.
     Examples of rooms are Temple Square, The Reading Room, and A Clearing.

Wizard 
     A game administrator.

--------------------QUICK REFRENCE---------------------

Trigger types and values

                          Mob trigger 
                                         ASCII flag 
                             Global
                                             a
                            Random
                                             b
                           Command
                                             c
                            Speech
                                             d
                              Act
                                             e
                             Death
                                              f
                             Greet
                                             g
                           Greet-All
                                             h
                             Entry
                                              i
                            Receive
                                              j
                             Fight
                                             k
                            HitPrcnt
                                              l
                             Bribe
                                             m


                          Obj trigger 
                                         ASCII flag 
                            Global
                                             a
                            Random
                                             b
                           Command
                                             c
                             Fight
                                             d
                             Get
                                             g
                             Drop
                                             h
                             Give
                                             i
                             Wear
                                             j


                          Wld trigger 
                                         ASCII flag 
                            Global
                                             a
                            Random
                                             b
                           Command
                                             c
                            Speech
                                             d
                             Enter
                                             g
                             Drop
                                             h




Special Commands

                               Mob Commands
                                   masound
                                     mat
                                    mecho
                                 mechoaround
                                    msend
                                    mexp
                                    mgold
                                    mforce
                                    mgoto
                                    mjunk
                                    mkill
                                    mload
                                   mpurge
                                   mteleport
                                    mcast


                               Object Commands
                                    oecho
                                 oechoaround
                                    oexp
                                    oforce
                                    oload
                                    opurge
                                    osend
                                   oteleport
                                   odamage
                                    oheal


                               World Commands
                                   wasound
                                     wat
                                    wdoor
                                    wecho
                                 wechoaround
                                    wexp
                                   wforce
                                    wload
                                   wpurge
                                    wsend
                                   wteleport
                                  wdamage
                                    wheal
                                  wzoneecho


 



Variable Fields

                                  Characters
                                     alias
                                     str
                                    stradd
                                     int
                                     wis
                                     dex
                                     con
                                     cha
                                    class
                                    level
                                    legal
                                    align
                                     hp
                                    maxhp
                                     gold
                                    name
                                     title
                                     race
                                     sex
                                    vnum
                                  canbeseen
                                    room


                                   Objects
                                    name
                                   shortdesc
                                     type
                                     val0
                                     val1
                                     val2
                                     val3
                                    vnum


                                   Rooms
                                    name
                                    north
                                     east
                                    south
                                    west
                                     up
                                    down




                                  Operators 
                                      ||
                                     &&
                                     ==
                                     !=
                                      <
                                      >
                                     <=
                                     >=
                                     /=
                                      -
                                      +
                                      /
                                      *
                                      !

			---------------THE END----------------

